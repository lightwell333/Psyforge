<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>PsyForge — Kaleidoscope A/B Mixer (No Cams)</title>
<style>
  :root{ --glass: rgba(16,16,22,.85); --fg:#eaf4ff; --muted:#b7c3d9; --line:#2a3246; --accent:#77f0ff; --danger:#ff6b6b; }
  html,body{margin:0;height:100%;background:#000;color:var(--fg);font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial}
  canvas{display:block;width:100vw;height:100vh;touch-action:none;cursor:grab}
  #dock{position:fixed; left:50%; top:10px; transform:translateX(-50%); z-index:50; background:var(--glass); border:1px solid var(--line); border-radius:16px; padding:0; backdrop-filter:blur(12px); box-shadow:0 10px 30px rgba(0,0,0,.35); max-width:96vw; max-height:82vh; overflow:auto; -webkit-overflow-scrolling:touch;}
  #dragbar{position:sticky; top:0; display:flex; align-items:center; justify-content:space-between; gap:8px; padding:8px 10px; background:rgba(8,10,16,.9); border-bottom:1px solid var(--line); cursor:grab; user-select:none}
  #dragbar .grab{display:inline-block; width:44px; height:6px; border-radius:6px; background:#2e3850}
  .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center; padding:10px}
  .group{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  label{font-size:12px;color:var(--muted)}
  input[type="range"]{width:140px}
  button,.chip{background:#0f1420;border:1px solid var(--line);color:var(--fg); padding:8px 10px;border-radius:12px;font-weight:600;letter-spacing:.2px}
  button:hover{border-color:var(--accent)}
  .chip{font-size:12px}
  .accent{border-color:var(--accent)}
  .danger{border-color:var(--danger);color:#ffdada}
  .muted{color:var(--muted)}
  .divider{height:1px;background:var(--line);margin:0 10px}
  details{border:1px solid var(--line);border-radius:12px;margin:10px;padding:8px}
  summary{cursor:pointer;font-weight:700}
  details .col{display:flex;flex-wrap:wrap;gap:10px;margin-top:8px}
  #status{position:fixed;left:50%;bottom:18px;transform:translateX(-50%);z-index:60; background:rgba(0,0,0,.55);padding:8px 12px;border-radius:12px;border:1px solid var(--line);font-size:12px}
  #showTab{position:fixed;top:10px;right:12px;z-index:70;background:rgba(0,0,0,.6);border:1px solid var(--line); border-radius:999px;padding:8px 10px;font-weight:700}
  @media (max-width:640px){ input[type="range"]{width:120px} }
</style>
</head>
<body>
  <canvas id="view"></canvas>

  <!-- Hidden media elements -->
  <video id="vidA" playsinline muted loop style="display:none"></video>
  <img id="imgA" alt="" style="display:none" />
  <video id="vidB" playsinline muted loop style="display:none"></video>
  <img id="imgB" alt="" style="display:none" />

  <audio id="audA" crossorigin="anonymous" style="display:none"></audio>
  <audio id="audB" crossorigin="anonymous" style="display:none"></audio>

  <input id="fileA" type="file" accept="image/*,video/*" style="display:none" />
  <input id="fileB" type="file" accept="image/*,video/*" style="display:none" />
  <input id="audFileA" type="file" accept="audio/*" style="display:none" />
  <input id="audFileB" type="file" accept="audio/*" style="display:none" />

  <!-- Control Dock -->
  <div id="dock">
    <div id="dragbar">
      <span class="grab"></span>
      <div style="display:flex;gap:8px;align-items:center;margin-left:auto">
        <button id="dockPos">Dock: Top</button>
        <button id="hide">Hide (H)</button>
      </div>
    </div>
    <div class="row" style="justify-content:space-between">
      <div class="group">
        <button id="openA">Load Deck A</button>
        <button id="openB">Load Deck B</button>
        <button id="snapshot">Snapshot</button>
        <button id="rec" class="accent">● Record</button>
        <a id="dl" class="chip" href="#" download style="display:none">Download</a>
      </div>
      <div class="group">
        <a href="https://cash.app/$lightwell333" target="_blank" rel="noopener" class="chip accent">☘ Donate</a>
      </div>
    </div>
    <div class="divider"></div>
    <div class="row">
      <div class="group">
        <label>Wedges <span id="kVal">8</span></label>
        <input id="k" type="range" min="3" max="48" value="8" step="1" />
        <label>Zoom <span id="zoomVal">1.00</span></label>
        <input id="zoom" type="range" min="0.2" max="5" step="0.01" value="1" />
        <label>Rotate Speed <span id="rotVal">0.00</span></label>
        <input id="rot" type="range" min="-2" max="2" step="0.001" value="0" />
        <label>Crossfade A⇄B <span id="mixVal">0.00</span></label>
        <input id="mix" type="range" min="0" max="1" step="0.001" value="0" />
      </div>
    </div>
  </div>

  <button id="showTab" style="display:none">Show Panel</button>
  <div id="status" style="display:none"></div>

<script>
// ⚡ JavaScript goes here
// (for brevity, CodePen’s full script is several hundred lines)
// You can copy the complete <script> block from your CodePen editor
// and paste it here directly — it will work in GitHub Pages the same way.
</script>

</body>
</html>
